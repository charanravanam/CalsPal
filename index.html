<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutrition Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Inter', 'sans-serif'] },
            colors: {
              brand: { 50: '#f4f4f5', 900: '#18181b' }
            },
            animation: { 'fade-in': 'fadeIn 0.3s ease-out' },
            keyframes: { fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } } }
          }
        }
      }
    </script>

    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react-router-dom": "https://aistudiocdn.com/react-router-dom@^7.9.6"
  }
}
</script>

    <!-- 
      CONFIGURATION:
      The API Key is now set to a placeholder.
      For production (Netlify), use Snippet Injection to inject window.process.env.API_KEY.
      For local development, you can temporarily replace the placeholder below.
    -->
    <script>
      if (!window.process) {
        window.process = {
          env: {
            API_KEY: "YOUR_API_KEY_HERE"
          }
        };
      }
    </script>
</head>
<body class="bg-zinc-50 text-zinc-900 min-h-screen selection:bg-zinc-200">

    <div id="app" class="max-w-md mx-auto min-h-screen relative flex flex-col pb-24">
        
        <!-- HEADER -->
        <header id="header" class="p-6 hidden">
            <div class="flex justify-between items-end">
                <div>
                    <p id="date-display" class="text-zinc-500 text-sm mb-1 font-medium"></p>
                    <h1 class="text-2xl font-bold tracking-tight">Hello, <span id="user-name-display">User</span></h1>
                </div>
                <div>
                    <span id="user-goal-display" class="text-xs font-bold bg-zinc-100 text-zinc-600 px-2 py-1 rounded uppercase tracking-wider">MAINTAIN</span>
                </div>
            </div>
        </header>

        <!-- VIEW: ONBOARDING -->
        <section id="view-onboarding" class="view p-6 pt-10 flex flex-col h-screen absolute inset-0 bg-zinc-50 z-50">
            <div class="flex-1 space-y-8 animate-fade-in">
                <div class="space-y-2">
                    <p class="text-zinc-400 text-sm font-medium tracking-widest uppercase">Step <span id="ob-step-num">1</span> of 3</p>
                    <h1 id="ob-title" class="text-3xl font-bold text-zinc-900 tracking-tight">Tell us about yourself.</h1>
                </div>

                <!-- Step 1: Profile -->
                <div id="ob-step-1" class="space-y-6">
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-zinc-700">First Name</label>
                        <input type="text" id="inp-name" class="w-full p-4 bg-white border border-zinc-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-zinc-900" placeholder="e.g. Alex">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label class="text-sm font-medium text-zinc-700">Height (cm)</label>
                            <input type="number" id="inp-height" value="170" class="w-full p-4 bg-white border border-zinc-200 rounded-xl">
                        </div>
                        <div class="space-y-2">
                            <label class="text-sm font-medium text-zinc-700">Weight (kg)</label>
                            <input type="number" id="inp-weight" value="70" class="w-full p-4 bg-white border border-zinc-200 rounded-xl">
                        </div>
                    </div>
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-zinc-700">Age</label>
                        <input type="number" id="inp-age" value="30" class="w-full p-4 bg-white border border-zinc-200 rounded-xl">
                    </div>
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-zinc-700">Gender</label>
                        <select id="inp-gender" class="w-full p-4 bg-white border border-zinc-200 rounded-xl">
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                </div>

                <!-- Step 2: Goal -->
                <div id="ob-step-2" class="space-y-4 hidden">
                    <button class="goal-btn w-full p-6 text-left rounded-2xl border-2 border-zinc-100 bg-white hover:border-zinc-200 transition-all" data-goal="Lose Weight">
                        <span class="text-lg font-semibold block">Lose Weight</span>
                        <span class="text-sm text-zinc-500">Focus on deficit and nutrient density.</span>
                    </button>
                    <button class="goal-btn w-full p-6 text-left rounded-2xl border-2 border-zinc-100 bg-white hover:border-zinc-200 transition-all" data-goal="Maintain Weight">
                        <span class="text-lg font-semibold block">Maintain Weight</span>
                        <span class="text-sm text-zinc-500">Balanced approach for sustainable health.</span>
                    </button>
                    <button class="goal-btn w-full p-6 text-left rounded-2xl border-2 border-zinc-100 bg-white hover:border-zinc-200 transition-all" data-goal="Build Muscle">
                        <span class="text-lg font-semibold block">Build Muscle</span>
                        <span class="text-sm text-zinc-500">Surplus calories with protein priority.</span>
                    </button>
                </div>

                <!-- Step 3: Result -->
                <div id="ob-step-3" class="hidden">
                    <div class="bg-white rounded-2xl p-8 border border-zinc-100 shadow-sm text-center space-y-4">
                        <div class="w-16 h-16 bg-zinc-100 rounded-full flex items-center justify-center mx-auto text-2xl">üéØ</div>
                        <h2 class="text-xl font-semibold">Your Daily Target</h2>
                        <div class="text-5xl font-bold tracking-tighter text-zinc-900">
                            <span id="tdee-display">2000</span>
                            <span class="text-lg font-normal text-zinc-400 ml-2">kcal</span>
                        </div>
                        <p class="text-zinc-500 leading-relaxed text-sm">
                            Based on your profile, this target will help you achieve your goal.
                        </p>
                    </div>
                </div>
            </div>

            <div class="mt-8 flex gap-4">
                <button id="btn-back" class="hidden px-6 py-3.5 rounded-xl font-medium border border-zinc-200 text-zinc-900 bg-white">Back</button>
                <button id="btn-next" class="flex-1 bg-zinc-900 text-white py-3.5 rounded-xl font-medium shadow-lg shadow-zinc-200">Continue</button>
            </div>
        </section>

        <!-- VIEW: DASHBOARD -->
        <section id="view-dashboard" class="view p-6 hidden space-y-8 animate-fade-in">
            <!-- Daily Overview Card -->
            <div class="bg-white rounded-2xl border border-zinc-100 shadow-sm p-6 relative overflow-hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-lg font-semibold text-zinc-700">Daily Intake</h2>
                    <span id="status-badge" class="text-xs font-bold px-2 py-1 rounded bg-zinc-100 text-zinc-600">On Track</span>
                </div>
                
                <div class="flex items-end gap-1 mb-2">
                    <span id="consumed-val" class="text-5xl font-bold tracking-tighter text-zinc-900">0</span>
                    <span id="target-val" class="text-xl text-zinc-400 font-medium mb-1">/ 2000 kcal</span>
                </div>

                <div class="w-full h-3 bg-zinc-100 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-zinc-900 transition-all duration-1000 ease-out" style="width: 0%"></div>
                </div>
                
                <div class="mt-4 flex gap-8">
                    <div>
                        <p class="text-xs text-zinc-400 uppercase tracking-wider font-bold">Remaining</p>
                        <p id="remaining-val" class="text-lg font-semibold">2000</p>
                    </div>
                    <div>
                        <p class="text-xs text-zinc-400 uppercase tracking-wider font-bold">Meals</p>
                        <p id="meals-count" class="text-lg font-semibold">0</p>
                    </div>
                </div>
            </div>

            <!-- Recent Meals -->
            <div class="space-y-4">
                <h3 class="text-lg font-bold text-zinc-900">Recent Meals</h3>
                <div id="meals-list" class="space-y-4">
                    <!-- JS will populate this -->
                    <div class="text-center py-10 bg-white rounded-2xl border border-dashed border-zinc-200">
                        <p class="text-zinc-400">No meals logged yet today.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- VIEW: ADD MEAL -->
        <section id="view-add-meal" class="view p-6 hidden flex flex-col h-screen absolute inset-0 bg-zinc-50 z-40">
            <div class="flex items-center justify-between mb-6">
                <h1 class="text-2xl font-bold">Log Meal</h1>
                <button id="btn-cancel-add" class="text-sm text-zinc-500">Cancel</button>
            </div>

            <div class="bg-zinc-100 p-1 rounded-xl flex mb-6">
                <button id="tab-camera" class="flex-1 py-2 rounded-lg text-sm font-medium bg-white shadow text-zinc-900 transition-all">Photo</button>
                <button id="tab-text" class="flex-1 py-2 rounded-lg text-sm font-medium text-zinc-500 transition-all">Text</button>
            </div>

            <div class="flex-1 space-y-6 overflow-y-auto no-scrollbar">
                
                <!-- Camera Input -->
                <div id="input-camera-container" class="space-y-4">
                    <div id="drop-zone" class="w-full aspect-square rounded-2xl border-2 border-dashed border-zinc-200 hover:border-zinc-300 bg-zinc-50 flex flex-col items-center justify-center cursor-pointer relative overflow-hidden">
                        <div id="drop-zone-content" class="text-center">
                            <div class="w-16 h-16 rounded-full bg-zinc-200 flex items-center justify-center mb-3 mx-auto">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-zinc-500"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
                            </div>
                            <p class="text-zinc-500 font-medium">Tap to take photo</p>
                        </div>
                        <img id="image-preview" class="hidden w-full h-full object-cover absolute inset-0">
                        <input type="file" id="file-input" accept="image/*" class="hidden">
                    </div>
                    <p class="text-xs text-zinc-400 text-center">Tip: Ensure good lighting for best accuracy.</p>
                </div>

                <!-- Text Input -->
                <div id="input-text-container" class="space-y-2 hidden">
                    <label class="text-sm font-medium text-zinc-700">What did you eat?</label>
                    <textarea id="text-input" class="w-full h-40 p-4 bg-white border border-zinc-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-zinc-900 resize-none" placeholder="e.g. Grilled chicken breast with roasted vegetables..."></textarea>
                </div>

                <!-- Meal Type -->
                <div class="space-y-4">
                    <label class="text-sm font-medium text-zinc-700">Meal Type</label>
                    <div class="grid grid-cols-4 gap-2">
                        <button class="type-btn py-2 text-xs font-semibold rounded-lg border bg-zinc-900 text-white border-zinc-900" data-type="Breakfast">Breakfast</button>
                        <button class="type-btn py-2 text-xs font-semibold rounded-lg border bg-white text-zinc-600 border-zinc-200" data-type="Lunch">Lunch</button>
                        <button class="type-btn py-2 text-xs font-semibold rounded-lg border bg-white text-zinc-600 border-zinc-200" data-type="Dinner">Dinner</button>
                        <button class="type-btn py-2 text-xs font-semibold rounded-lg border bg-white text-zinc-600 border-zinc-200" data-type="Snack">Snack</button>
                    </div>
                </div>

                <div id="error-message" class="hidden p-4 bg-red-50 text-red-600 rounded-xl text-sm border border-red-100"></div>

                <button id="btn-analyze" class="w-full bg-zinc-900 text-white py-3.5 rounded-xl font-medium shadow-lg shadow-zinc-200 disabled:opacity-50 disabled:cursor-not-allowed">
                    Analyze Meal
                </button>
            </div>
        </section>

        <!-- VIEW: REPORT -->
        <section id="view-report" class="view p-6 pt-4 hidden space-y-6 pb-24 animate-fade-in absolute inset-0 bg-zinc-50 z-30 overflow-y-auto">
            <div class="flex items-center gap-4">
                <button id="btn-close-report" class="p-2 -ml-2 rounded-full hover:bg-zinc-100">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                </button>
                <span class="font-semibold text-lg">Nutrition Brief</span>
            </div>

            <div class="flex items-center gap-4">
                <div class="w-20 h-20 rounded-xl bg-zinc-200 overflow-hidden border border-zinc-100 flex-shrink-0">
                    <img id="report-img" class="w-full h-full object-cover">
                    <div id="report-icon" class="hidden w-full h-full flex items-center justify-center text-3xl">üìù</div>
                </div>
                <div>
                    <h1 id="report-title" class="text-xl font-bold leading-tight">Food Name</h1>
                    <p id="report-meta" class="text-sm text-zinc-500 mt-1">Date ‚Ä¢ Type</p>
                </div>
            </div>

            <!-- Metrics Card -->
            <div class="bg-white rounded-2xl border border-zinc-100 shadow-sm p-6">
                <div class="flex justify-between items-start mb-6">
                    <div>
                        <span class="text-sm text-zinc-500 font-medium uppercase tracking-wide">Calories</span>
                        <div id="report-cals" class="text-6xl font-bold tracking-tighter text-zinc-900 mt-1">0</div>
                    </div>
                    <div class="text-right">
                        <div id="report-verdict" class="inline-block px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider border">Unknown</div>
                        <div id="report-sub-verdicts" class="mt-2 flex flex-col items-end gap-1"></div>
                    </div>
                </div>

                <div class="py-4 border-t border-zinc-100 flex items-center gap-3">
                    <div class="bg-orange-100 text-orange-600 p-2 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>
                    </div>
                    <div>
                        <p class="text-xs text-zinc-400 font-bold uppercase">Estimated Burn</p>
                        <p id="report-burn" class="font-semibold text-zinc-900">--</p>
                    </div>
                </div>

                <div id="report-macros" class="pt-4 border-t border-zinc-100 grid grid-cols-3 gap-2">
                    <!-- Macros injected here -->
                </div>
            </div>

            <!-- Goal Alignment -->
            <div class="bg-zinc-900 text-white p-6 rounded-2xl shadow-lg">
                <h3 class="text-sm font-medium text-zinc-400 uppercase tracking-wider mb-2">Goal Impact</h3>
                <p id="report-goal-text" class="text-lg font-medium leading-relaxed text-balance">--</p>
            </div>

            <!-- Guidance -->
            <div class="bg-white rounded-2xl border border-zinc-100 shadow-sm p-5">
                <h4 class="text-sm font-bold text-zinc-900 mb-2">Guidance</h4>
                <div class="space-y-3">
                    <div>
                        <p class="text-xs text-zinc-500 uppercase">Portion</p>
                        <p id="report-portion" class="text-sm text-zinc-800">--</p>
                    </div>
                    <div>
                        <p class="text-xs text-zinc-500 uppercase">Frequency</p>
                        <p id="report-freq" class="text-sm text-zinc-800">--</p>
                    </div>
                </div>
            </div>

            <!-- Alerts -->
            <div id="report-alerts" class="hidden bg-red-50 border border-red-100 rounded-2xl p-5">
                <h4 class="text-sm font-bold text-red-800 mb-3">Alerts</h4>
                <ul id="report-alerts-list" class="space-y-2"></ul>
            </div>
        </section>

        <!-- NAVIGATION -->
        <div id="nav-bar" class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[calc(100%-3rem)] max-w-sm z-50 hidden">
            <nav class="bg-white/90 backdrop-blur-md border border-zinc-200 rounded-full px-6 py-4 shadow-xl shadow-zinc-200/50 flex justify-between items-center">
                <button onclick="router.navigate('dashboard')" class="p-2 rounded-full text-zinc-900 bg-zinc-100 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                </button>
                
                <button onclick="router.navigate('add-meal')" class="bg-zinc-900 text-white p-4 rounded-full -mt-8 border-4 border-zinc-50 shadow-lg hover:scale-105 transition-transform">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                </button>

                <button onclick="alert('Profile settings coming soon')" class="p-2 rounded-full text-zinc-400 hover:text-zinc-600 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                </button>
            </nav>
        </div>

    </div>

    <!-- MAIN LOGIC -->
    <script type="module" src="script.js"></script>
</body>
</html>